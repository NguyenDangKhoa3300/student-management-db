CREATE DATABASE QUANLYGV;

USE QUANLYGV;

DROP DATABASE QUANLYGV

CREATE TABLE THAMGIADT(
	MAGV char(3),
	MADT char(3),
	STT int,
	PHUCAP numeric(3,1),
	KETQUA nvarchar(5),
	PRIMARY KEY(MAGV, MADT, STT)
)

-- DROP TABLE THAMGIADT

CREATE TABLE CONGVIEC(
	MADT char(3),
	STT int,
	TENCV nvarchar(24),
	NGAYBD date,
	NGAYKT date,
	PRIMARY KEY (MADT, STT)
)

-- ALTER TABLE CONGVIEC
-- ALTER COLUMN TENCV nvarchar(24)

CREATE TABLE DETAI(
	MADT char(3),
	TENDT nvarchar(40),
	CAPQL nvarchar(10),
	KINHPHI numeric(5,1),
	NGAYBD date,
	NGAYKT date,
	MACD char(5),
	GVCNDT char(3),
	PRIMARY KEY (MADT)
)

-- ALTER TABLE DETAI
-- ALTER COLUMN GVCNDT char(3);

CREATE TABLE CHUDE(
	MACD char(5),
	TENCD nvarchar(25)
	PRIMARY KEY (MACD)
)

-- DROP TABLE CHUDE

CREATE TABLE KHOA(
	MAKHOA char(5),
	TENKHOA nvarchar(20),
	NAMTL char(4),
	PHONG varchar(5),
	DIENTHOAI char (11),
	TRUONGKHOA char(3),
	NGAYNHANCHUC date,
	PRIMARY KEY (MAKHOA)
)

-- ALTER TABLE KHOA 
-- ADD TRUONGKHOA char(3);

CREATE TABLE BOMON(
	MABM char(5),
	TENBM nvarchar(20),
	PHONG varchar(5),
	DIENTHOAI char(11),
	TRUONGBM char(3),
	MAKHOA char(5),
	NGAYNHANCHUC date,
	PRIMARY KEY (MABM)
)
-- DROP TABLE BOMON

CREATE TABLE GIAOVIEN(
	MAGV char(3),
	HOTEN nvarchar(20),
	LUONG numeric(5,1),
	PHAI nvarchar(5),
	NGSINH date,
	DIACHI varchar(50),
	GVQLCM char(3),
	MABM char(5),
	PRIMARY KEY (MAGV)
)

CREATE TABLE NGUOITHAN(
	MAGV char(3),
	TEN nvarchar(20),
	NGSINH date,
	PHAI nvarchar(3),
	PRIMARY KEY (MAGV, TEN)
)

CREATE TABLE GV_DT(
	MAGV char(3),
	DIENTHOAI char(11)
	PRIMARY KEY (MAGV, DIENTHOAI)
)
-- THAY ĐỔI THÔNG TIN BẢNG
ALTER TABLE THAMGIADT
ADD CONSTRAINT FK_THAMGIADT_CONGVIEC
FOREIGN KEY (MADT, STT) REFERENCES CONGVIEC (MADT, STT);

ALTER TABLE THAMGIADT
ADD CONSTRAINT FK_THAMGIADT_GIAOVIEN
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN (MAGV);

ALTER TABLE CONGVIEC
ADD CONSTRAINT FK_CONGVIEC_DETAI
FOREIGN KEY (MADT) REFERENCES DETAI (MADT);

ALTER TABLE DETAI 
ADD CONSTRAINT FK_DETAI_CHUDE
FOREIGN KEY (MACD) REFERENCES CHUDE (MACD);

ALTER TABLE DETAI 
ADD CONSTRAINT FK_DETAI_GIAOVIEN
FOREIGN KEY (GVCNDT) REFERENCES GIAOVIEN (MAGV);


ALTER TABLE KHOA 
ADD CONSTRAINT FK_KHOA_GIAOVIEN
FOREIGN KEY (TRUONGKHOA) REFERENCES GIAOVIEN (MAGV);

ALTER TABLE BOMON 
ADD CONSTRAINT FK_BOMON_KHOA
FOREIGN KEY (MAKHOA) REFERENCES KHOA (MAKHOA);

ALTER TABLE BOMON 
ADD CONSTRAINT FK_BOMON_GIAOVIEN
FOREIGN KEY (TRUONGBM) REFERENCES GIAOVIEN (MAGV);

ALTER TABLE GV_DT
ADD CONSTRAINT FK_GVDT_GIAOVIEN
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN (MAGV); -- pk

ALTER TABLE NGUOITHAN
ADD CONSTRAINT FK_NGUOITHAN_GIAOVIEN
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN (MAGV);

ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_GIAOVIEN
FOREIGN KEY (GVQLCM) REFERENCES GIAOVIEN(MAGV);

ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_BOMON
FOREIGN KEY (MABM) REFERENCES BOMON(MABM);

-- Insert values

INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('001', 1, N'Khởi tạo và Lập kế hoạch', '2007-10-20', '2008-12-20')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('001', 2, N'Xác định yêu cầu', '2008-12-21', '2008-03-21')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('001', 3, N'Phân tích hệ thống', '2008-03-22', '2008-05-22')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('001', 4, N'Thiết kế hệ thống', '2008-05-23', '2008-06-23')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('001', 5, N'Cài đặt thử nghiệm', '2008-06-24', '2008-10-20')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('002', 1, N'Khởi tạo và Lập kế hoạch', '2009-05-10', '2009-07-10')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('002', 2, N'Xác định yêu cầu', '2009-07-11', '2009-10-11')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('002', 3, N'Phân tích hệ thống', '2009-10-12', '2009-12-20')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('002', 4, N'Thiết kế hệ thống', '2009-12-21', '2010-03-22')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('002', 5, N'Cài đặt thử nghiệm', '2010-03-23', '2008-08-21')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('006', 1, N'Lấy mẫu', '2006-10-20', '2007-02-20')
INSERT INTO CONGVIEC (MADT, STT, TENCV, NGAYBD, NGAYKT)
VALUES('006', 2, N'Nuôi cấy', '2007-02-21', '2008-08-21')

-- DELETE FROM CONGVIEC

INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('001', '002', 1, '0.0', NULL)
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('001', '002', 2, '2.0', NULL)
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('002', '001', 4, '2.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('003', '001', 1, '1.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('003', '001', 2, '0.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('003', '001', 4, '1.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('003', '002', 2, '0.0', NULL)
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('004', '006', 1, '0.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('004', '006', 2, '1.0', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('006', '006', 2, '1.5', N'Đạt')
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('009', '002', 3, '0.5', NULL)
INSERT INTO THAMGIADT (MAGV, MADT, STT, PHUCAP, KETQUA)
VALUES ('009', '002', 4, '1.5', NULL)

INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('001', N'Hùng', '1990-01-14', N'Nam')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('001', N'Thủy', '1994-12-08', N'Nữ')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('003', N'Hà', '1998-09-03', N'Nữ')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('003', N'Thu', '1998-09-03', N'Nữ')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('007', N'Mai', '2003-03-26', N'Nữ')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('007', N'Vy', '2000-02-14', N'Nữ')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('008', N'Nam', '1991-05-06', N'Nam')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('009', N'An', '1996-01-14', N'Nam')
INSERT INTO NGUOITHAN (MAGV, TEN, NGSINH, PHAI)
VALUES ('010', N'Nguyệt', '2006-01-14', N'Nữ')

INSERT INTO KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC)
VALUES ('CNTT', N'Công nghệ thông tin', '1995', 'B11', '0838123456', '002', '2005-02-20')
INSERT INTO KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC)
VALUES ('HH', N'Hóa học', '1980', 'B41', '0838456456', '007', '2001-10-15')
INSERT INTO KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC)
VALUES ('SH', N'Sinh học', '1980', 'B31', '0838454545', '004', '2000-10-11')
INSERT INTO KHOA (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC)
VALUES ('VL', N'Vật lý', '1976', 'B21', '0838223223', '005', '2003-09-18')

INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('001', N'Nguyễn Hoài An', '2000.0', N'Nam', '1973-02-15', N'25/3 Lạc Long Quân, Q.10, TP HCM', NULL, NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('002', N'Trần Trà Hương', '2500.0', N'Nữ', '1960-06-20', N'125 Trần Hưng Đạo, Q.1, TP HCM,', NULL, NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('003', N'Nguyễn Ngọc Ánh', '2200.0', N'Nữ', '1975-05-11', N'12/21 Võ Văn Ngân, Thủ Đức, TP HCM', '002', NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('004', N'Trương Nam Sơn', '2300.0', N'Nam', '1959-06-20', N'215 Lý Thường Kiệt, TP Biên Hòa', NULL, NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('005', N'Lý Hoàng Hà', '2500.0', N'Nam', '1954-10-23', N'22/5 Nguyễn Xí, Q. Bình Thạnh, TP HCM', NULL, NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('006', N'Trần Bạch Tuyết', '1500.0', N'Nữ', '1980-05-20', N'127 Hùng Vương, TP Mỹ Tho', '004', NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('007', N'Nguyễn An Trung', '2100.0', N'Nam', '1976-06-05', N'234 3/2, TP Biên Hòa', NULL, NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('008', N'Trần Trung Hiếu', '1800.0', N'Nam', '1977-08-06', N'22/11 Lý Thường Kiệt, TP Mỹ Tho', '007', NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('009', N'Trần Hoàng Nam', '2000.0', N'Nam', '1975-11-22', N'234 Trần Não, An Phú, TP HCM', '001', NULL)
INSERT INTO GIAOVIEN (MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES ('010', N'Phạm Nam Thanh', '1500.0', N'Nam', '1980-12-12', N'221 Hùng Vương, Q.5, TP HCM', '007', NULL)

INSERT INTO CHUDE (MACD, TENCD)
VALUES ('NCPT', N'Nghiên cứu phát triển')
INSERT INTO CHUDE (MACD, TENCD)
VALUES ('QLGD', N'Quản lý giáo dục')
INSERT INTO CHUDE (MACD, TENCD)
VALUES ('UDCN', N'Ứng dụng công nghệ')

INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('001', N'HTTT quản lý các trường ĐH', 'ĐHQG', 20.0, '2007-10-20', '2008-10-20', 'QLGD', '002')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('002', N'HTTT quản lý giáo vụ cho một Khoa', 'Trường', 20.0, '2000-10-12', '2001-10-12', 'QLGD', '002')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('003', N'Nghiên cứu chế tạo sợi Nano Platin', 'ĐHQG', 300.0, '2008-05-15', '2010-05-15', 'NCPT', '005')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('004', N'Tạo vật liệu sinh học bằng màng ối người', 'Nhà nước', 100.0, '2007-01-01', '2009-12-31', 'NCPT', '004')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('005', N'Ứng dụng hóa học xanh', 'Trường', 200.0, '2003-10-10', '2004-12-10', 'UDCN', '007')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('006', N'Nghiên cứu tế bào gốc', 'Nhà nước', 4000.0, '2006-10-20', '2009-10-20', 'NCPT', '004')
INSERT INTO DETAI(MADT, TENDT, CAPQL, KINHPHI, NGAYBD, NGAYKT, MACD, GVCNDT)
VALUES ('007', N'HTTT quản lý các trường ĐH', 'ĐHQG', 20.0, '2009-05-10', '2010-05-10', 'QLGD', '001')

INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('CNTT', N'Công nghệ tri thức', 'B15', '0838126126', NULL, 'CNTT', NULL)
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('HHC', N'Hóa hữu cơ', 'B44', '838222222', NULL, 'HH', NULL)
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('HL', N'Hóa lý', 'B42', '0838878787', NULL, 'HH', NULL)
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('HPT', N'Hóa phân tích', 'B43', '0838777777', '007', 'HH', '2007-10-15')
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('HTTT', N'Hệ thống thông tin', 'B13', '0838125125', '002', 'CNTT', '2004-09-20')
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('MMT', N'Mạng máy tính', 'B16', '0838676767', '001', 'CNTT', '2005-05-15')
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('SH', N'Sinh hóa', 'B33', '0838898989', NULL, 'SH', NULL)
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('VLDT', N'Vật lý điện tử', 'B23', '0838234234', NULL, 'VL', NULL)
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('VLUD', N'Vật lý ứng dụng', 'B24', '0838454545', '005', 'VL', '2006-02-18')
INSERT INTO BOMON (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES ('VS', N'Vi sinh', 'B32', '0838909090', '004', 'SH', '2007-01-01')

INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('001', '0838912112')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('001', '0903123123')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('002', '0913454545')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('003', '0838121212')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('003', '0903656565')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('003', '0937125125')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('006', '0937888888')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('008', '0653717171')
INSERT INTO GV_DT (MAGV, DIENTHOAI)
VALUES ('008', '0913232323')

UPDATE GIAOVIEN
SET MABM = 'MMT' WHERE MAGV = '001'
UPDATE GIAOVIEN
SET MABM = 'MMT' WHERE MAGV = '009'
UPDATE GIAOVIEN
SET MABM = 'HTTT' WHERE MAGV = '002'
UPDATE GIAOVIEN
SET MABM = 'HTTT' WHERE MAGV = '003'
UPDATE GIAOVIEN
SET MABM = 'VS' WHERE MAGV = '004'
UPDATE GIAOVIEN
SET MABM = 'VS' WHERE MAGV = '006'
UPDATE GIAOVIEN
SET MABM = 'VLDT' WHERE MAGV = '005'
UPDATE GIAOVIEN
SET MABM = 'HPT' WHERE MAGV = '007'
UPDATE GIAOVIEN
SET MABM = 'HPT' WHERE MAGV = '008'
UPDATE GIAOVIEN
SET MABM = 'HPT' WHERE MAGV = '010'

DROP TABLE BOMON
DELETE CONGVIEC WHERE MADT = 1

-- Q1. Cho biết họ tên và mức lương của các giáo viên nữ.  
SELECT HOTEN, LUONG
FROM GIAOVIEN
WHERE PHAI = N'Nữ'

-- Q2. Cho biết họ tên của các giáo viên và lương của họ sau khi tăng 10% 
SELECT HOTEN, LUONG * 1.1
FROM GIAOVIEN

-- Q3. Cho biết mã của các giáo viên có họ tên bắt đầu là “Nguyễn” và lương trên $2000 hoặc, giáo viên là trưởng bộ môn nhận chức sau năm 1995. 
SELECT MAGV, HOTEN, LUONG
FROM GIAOVIEN
WHERE HOTEN LIKE N'Nguyễn%' AND LUONG > 2000

SELECT MAGV, HOTEN, LUONG 
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE YEAR(BM.NGAYNHANCHUC) > 1995 AND GV.MAGV = BM.TRUONGBM

-- Q4. Cho biết tên những giáo viên khoa Công nghệ thông tin.
SELECT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K
WHERE GV.MABM = BM.MABM AND BM.MABM = K.MAKHOA AND K.TENKHOA = N'Công nghệ thông tin'

-- Q5. Cho biết thông tin của bộ môn cùng thông tin giảng viên làm trưởng bộ môn đó.
SELECT *
FROM BOMON AS BM, GIAOVIEN AS GV
WHERE BM.TRUONGBM = GV.MAGV

-- Q6. Với mỗi giáo viên, hãy cho biết thông tin của bộ môn mà họ đang làm việc 
SELECT GV.HOTEN, BM.MABM, BM.TENBM, BM.PHONG, BM.DIENTHOAI, BM.TRUONGBM, BM.MAKHOA, BM.NGAYNHANCHUC
FROM GIAOVIEN AS GV
JOIN BOMON AS BM
ON GV.MABM = BM.MABM
-- Q7. Cho biết tên đề tài và giáo viên chủ nhiệm đề tài.
SELECT DT.TENDT, GV.HOTEN
FROM DETAI AS DT, GIAOVIEN AS GV
WHERE DT.GVCNDT = GV.MAGV

-- Q8. Với mỗi khoa cho biết thông tin trưởng khoa.
SELECT GV.HOTEN
FROM KHOA AS K, GIAOVIEN AS GV
WHERE K.TRUONGKHOA = GV.MAGV

-- Q9. Cho biết các giáo viên của bộ môn “Vi sinh” có tham gia đề tài 006. 
SELECT DISTINCT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, THAMGIADT AS TGDT
WHERE GV.MABM = BM.MABM AND TENBM = N'Vi sinh' AND GV.MAGV = TGDT.MAGV 

-- Q10. Với những đề tài thuộc cấp quản lý “Thành phố”, cho biết mã đề tài, đề tài thuộc về chủ đề nào, họ tên người chủ nghiệm đề tài cùng với ngày sinh và địa chỉ của người ấy.
SELECT DT.MADT, CD.TENCD, GV.HOTEN, GV.NGSINH, GV.DIACHI
FROM DETAI AS DT, CHUDE AS CD, GIAOVIEN AS GV
WHERE DT.CAPQL = N'Nhà nu?c' AND DT.MACD = CD.MACD AND DT.GVCNDT = GV.MAGV

--Q11. Tìm họ tên của từng giáo viên và người phụ trách chuyên môn trực tiếp của giáo viên đó.  
SELECT GV1.HOTEN AS GIAOVIEN, GV2.HOTEN AS GVQLCM
FROM GIAOVIEN AS GV1
LEFT JOIN GIAOVIEN AS GV2
ON GV1.MAGV = GV2.GVQLCM

--Q12. Tìm họ tên của những giáo viên được “Nguyễn Thanh Tùng” phụ trách trực tiếp. 
SELECT HOTEN 
FROM GIAOVIEN AS GV1
WHERE GV1.GVQLCM = 
(
	SELECT MAGV 
	FROM GIAOVIEN AS GV2
	WHERE GV2.HOTEN = N'Nguyễn Thanh Tùng'
)

-- Q13. Cho biết tên giáo viên là trưởng bộ môn Hệ thống thông tin.
SELECT GV.HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE BM.TENBM = N'Hệ thống thông tin' AND GV.MAGV = BM.TRUONGBM 

-- Q14. Cho biết tên người chủ nhiệm đề tài của những đề tài thuộc chủ đề Quản lý giáo dục.
SELECT DISTINCT GV.HOTEN
FROM GIAOVIEN AS GV, DETAI AS DT, CHUDE AS CD
WHERE DT.GVCNDT = GV.MAGV AND DT.MACD = CD.MACD AND CD.TENCD = N'Quản lý giáo dục'

--Q15. Cho biết tên các công việc của đề tài HTTT quản lý các trường ĐH có thời gian bắt đầu trong tháng 3/2008.  
SELECT CV.TENCV, CV.NGAYBD
FROM CONGVIEC AS CV, DETAI AS DT
WHERE CV.MADT = DT.MADT AND DT.TENDT = N'HTTT quản lý các trường ĐH' AND MONTH(CV.NGAYBD) = 3 AND YEAR(CV.NGAYBD) = 2008

--Q16. Cho biết tên giáo viên và tên người quản lý chuyên môn của giáo viên đó. 
SELECT GV1.HOTEN AS GIAOVIEN, GV2.HOTEN AS GVQLCM
FROM GIAOVIEN AS GV1
LEFT JOIN GIAOVIEN AS GV2
ON GV1.MAGV = GV2.GVQLCM

-- Q17. Cho các công việc bắt đầu trong khoảng từ 01/01/2007 đến 01/08/2007. --
SELECT TENCV
FROM CONGVIEC
WHERE NGAYBD BETWEEN '2007-01-01' AND '2007-08-01';

-- DO AGAIN Q18. Cho biết họ tên các giáo viên cùng bộ môn với giáo viên “Trần Trà Hương” 
SELECT HOTEN
FROM GIAOVIEN AS GV1
WHERE GV1.MABM = 
(
	SELECT BM.MABM
	FROM GIAOVIEN AS GV2, BOMON AS BM
	WHERE GV2.MABM = BM.MABM AND GV2.HOTEN = N'Trần Trà Hương'
)
-- Q19. Tìm những giáo viên vừa là trưởng bộ môn vừa chủ nhiệm đề tài.
SELECT DISTINCT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, DETAI AS DT
WHERE GV.MAGV = BM.TRUONGBM AND GV.MAGV = DT.GVCNDT

-- Q20. Cho biết tên những giáo viên vừa là trưởng khoa và vừa là trưởng bộ môn.
SELECT DISTINCT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K
WHERE GV.MAGV = BM.TRUONGBM AND GV.MAGV = K.TRUONGKHOA

-- Q21. Cho biết tên những trưởng bộ môn mà vừa chủ nhiệm đề tài
SELECT DISTINCT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, DETAI AS DT
WHERE GV.MAGV = BM.TRUONGBM AND GV.MAGV = DT.GVCNDT

-- Q22. Cho biết mã số các trưởng khoa có chủ nhiệm đề tài.
SELECT DISTINCT GV.MAGV
FROM GIAOVIEN AS GV, KHOA AS K, DETAI AS DT
WHERE GV.MAGV = K.TRUONGKHOA AND GV.MAGV = DT.GVCNDT

-- Q23. Cho biết mã số các giáo viên thuộc bộ môn HTTT hoặc có tham gia đề tài mã 001.
SELECT DISTINCT GV.MAGV
FROM GIAOVIEN AS GV,BOMON AS BM, THAMGIADT AS TGDT
WHERE GV.MABM = BM.MABM AND BM.MABM = 'HTTT' 
OR GV.MAGV = TGDT.MAGV AND TGDT.MADT = '001'

-- Q24. Cho biết giáo viên làm việc cùng bộ môn với giáo viên 002.
SELECT GV.HOTEN 
FROM GIAOVIEN AS GV
WHERE GV.MABM = 
(
	SELECT BM.MABM
	FROM BOMON AS BM, GIAOVIEN AS GV
	WHERE BM.MABM = GV.MABM AND GV.MAGV = '002'
)

-- Q25. Tìm những giáo viên là trưởng bộ môn.
SELECT GV.HOTEN 
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MAGV = BM.TRUONGBM

-- Q26. Cho biết họ tên và mức lương của các giáo viên.
SELECT HOTEN, LUONG
FROM GIAOVIEN

-- Q27. Cho biết số lượng giáo viên viên và tổng lương của họ.
SELECT COUNT(*), SUM(LUONG) 
FROM GIAOVIEN

--NEED TEST Q28. Cho biết số lượng giáo viên và lương trung bình của từng bộ môn. 
SELECT LUONG ,AVG(LUONG)
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM
GROUP BY GV.MABM

-- Q29. Cho biết tên chủ đề và số lượng đề tài thuộc về chủ đề đó.
SELECT CD.TENCD, COUNT(*) AS SOLUONG
FROM CHUDE AS CD, DETAI AS DT
WHERE CD.MACD = DT.MACD
GROUP BY CD.TENCD

-- Q30. Cho biết tên giáo viên và số lượng đề tài mà giáo viên đó tham gia.
SELECT GV.HOTEN, COUNT(*) AS SOLUONG
FROM GIAOVIEN AS GV, THAMGIADT AS TGDT
WHERE GV.MAGV = TGDT.MAGV
GROUP BY GV.HOTEN

-- Q31. Cho biết tên giáo viên và số lượng đề tài mà giáo viên đó làm chủ nhiệm
SELECT GV.HOTEN, COUNT(*) AS SOLUONG
FROM GIAOVIEN AS GV, DETAI AS DT
WHERE GV.MAGV = DT.GVCNDT
GROUP BY GV.HOTEN

-- Q32. Với mỗi giáo viên cho tên giáo viên và số người thân của giáo viên đó. 
SELECT GV.HOTEN, COUNT(*) AS SOLUONG
FROM GIAOVIEN AS GV, NGUOITHAN AS NT
WHERE GV.MAGV = NT.MAGV
GROUP BY GV.HOTEN

-- Q33. Cho biết tên những giáo viên đã tham gia từ 3 đề tài trở lên. 
SELECT GV.HOTEN
FROM GIAOVIEN AS GV, THAMGIADT AS TGDT
WHERE GV.MAGV = TGDT.MAGV
GROUP BY GV.HOTEN
HAVING COUNT(*) > 3

-- Q34. Cho biết số lượng giáo viên đã tham gia vào đề tài Ứng dụng hóa học xanh.
SELECT COUNT(*) AS SOLUONG
FROM GIAOVIEN AS GV, THAMGIADT AS TGDT, DETAI AS DT
WHERE GV.MAGV = TGDT.MAGV AND TGDT.MADT = DT.MADT AND DT.TENDT = N'Ứng dụng hóa học xanh'

-- Q35. Cho biết mức lương cao nhất của các giảng viên.
SELECT MAX(LUONG)
FROM GIAOVIEN

-- Q36. Cho biết những giáo viên có lương lớn nhất.
SELECT HOTEN
FROM GIAOVIEN
WHERE LUONG = 
(
	SELECT MAX(LUONG)
	FROM GIAOVIEN
)

-- Q37. Cho biết lương cao nhất trong bộ môn “HTTT”.
SELECT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM AND BM.MABM = 'HTTT' AND LUONG =
(
	SELECT MAX(LUONG)
	FROM GIAOVIEN
)

-- Q38. Cho biết tên giáo viên lớn tuổi nhất của bộ môn Hệ thống thông tin.
SELECT HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM AND BM.MABM = 'HTTT' AND NGSINH = 
(
	SELECT MIN(NGSINH)
	FROM GIAOVIEN AS GV, BOMON AS BM
	WHERE GV.MABM = BM.MABM AND BM.MABM = 'HTTT'
)

-- Q39. Cho biết tên giáo viên nhỏ tuổi nhất khoa Công nghệ thông tin.
SELECT GV1.HOTEN
FROM GIAOVIEN AS GV1, KHOA AS K, BOMON AS BM
WHERE GV1.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA AND K.MAKHOA = 'CNTT' AND GV1.NGSINH = 
(
	SELECT MAX(GV2.NGSINH)
	FROM GIAOVIEN AS GV2, KHOA AS K, BOMON AS BM
	WHERE GV2.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA AND K.MAKHOA = 'CNTT'
)

-- Q40. Cho biết tên giáo viên và tên khoa của giáo viên có lương cao nhất.
SELECT GV.HOTEN, K.TENKHOA
FROM GIAOVIEN AS GV, KHOA AS K, BOMON AS BM
WHERE GV.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA AND GV.LUONG = 
(
	SELECT MAX(LUONG)
	FROM GIAOVIEN
)

-- Q41. Cho biết những giáo viên có lương lớn nhất trong bộ môn của họ.
SELECT * 
FROM GIAOVIEN AS GV
JOIN (
	SELECT MAX(LUONG) AS LUONG, MABM 
	FROM GIAOVIEN
	GROUP BY MABM
) AS TEMP ON TEMP.MABM = GV.MABM AND TEMP.LUONG = GV.LUONG;

-- Q42. Cho biết tên những đề tài mà giáo viên Nguyễn Hoài An chưa tham gia.
SELECT DISTINCT DT.MADT, DT.TENDT
FROM DETAI AS DT, THAMGIADT AS TGDT
WHERE DT.MADT = TGDT.MADT AND TGDT.MADT <> -- dấu khác
(
	SELECT DISTINCT DT.MADT
	FROM GIAOVIEN AS GV, DETAI AS DT, THAMGIADT AS TGDT
	WHERE GV.MAGV = TGDT.MAGV AND DT.MADT = TGDT.MADT AND GV.HOTEN = N'Nguyễn Hoài An'
)

-- Q43. Cho biết những đề tài mà giáo viên Nguyễn Hoài An chưa tham gia. Xuất ra tên đề tài, tên người chủ nhiệm đề tài.
SELECT DISTINCT DT.MADT, DT.TENDT, GV.HOTEN
FROM GIAOVIEN AS GV, DETAI AS DT, THAMGIADT AS TGDT
WHERE GV.MAGV = DT.GVCNDT AND DT.MADT = TGDT.MADT AND TGDT.MADT <>
(
	SELECT DISTINCT DT.MADT
	FROM GIAOVIEN AS GV, DETAI AS DT, THAMGIADT AS TGDT
	WHERE GV.MAGV = TGDT.MAGV AND DT.MADT = TGDT.MADT AND GV.HOTEN = N'Nguyễn Hoài An'
)

-- Q44. Cho biết tên những giáo viên khoa Công nghệ thông tin mà chưa tham gia đề tài nào.
SELECT GV.HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K
WHERE GV.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA AND K.TENKHOA = N'Công nghệ thông tin' AND GV.MAGV NOT IN
(
	SELECT DISTINCT MAGV
	FROM THAMGIADT
)
-- Q45. Tìm những giáo viên không tham gia bất kỳ đề tài nào
SELECT GV.HOTEN
FROM GIAOVIEN AS GV
WHERE GV.MAGV NOT IN 
(
	SELECT MAGV
	FROM THAMGIADT
)

-- Q46. Cho biết giáo viên có lương lớn hơn lương của giáo viên “Nguyễn Hoài An”
SELECT HOTEN
FROM GIAOVIEN 
WHERE LUONG > 
(
	SELECT LUONG 
	FROM GIAOVIEN
	WHERE HOTEN = N'Nguyễn Hoài An'
)

-- NEED TEST Q47. Tìm những trưởng bộ môn tham gia tối thiểu 1 đề tài
SELECT BM.TRUONGBM
FROM BOMON AS BM, GIAOVIEN AS GV
WHERE BM.TRUONGBM = GV.MAGV AND 1 <= 
(
	SELECT MADT, COUNT(*)
	FROM THAMGIADT
	GROUP BY MADT 
)


-- Q48. Tìm giáo viên trùng tên và cùng giới tính với giáo viên khác trong cùng bộ môn
SELECT *
FROM GIAOVIEN AS GV1, GIAOVIEN AS GV2
WHERE GV1.HOTEN = GV2.HOTEN AND GV1.PHAI = GV2.PHAI AND GV1.MAGV != GV2.MAGV AND GV1.MABM = GV2.MABM
-- Q49. Tìm những giáo viên có lương lớn hơn lương của ít nhất một giáo viên bộ môn “Công nghệ phần mềm”

-- Q50. Tìm những giáo viên có lương lớn hơn lương của tất cả giáo viên thuộc bộ môn “Hệ thống thông tin”
SELECT * 
FROM GIAOVIEN
WHERE LUONG > 
(
	SELECT MAX(GV.LUONG) AS MAX
	FROM GIAOVIEN AS GV, BOMON AS BM
	WHERE GV.MABM = BM.MABM AND BM.TENBM = N'Hệ thống thông tin'
)

-- Q51. Cho biết tên khoa có đông giáo viên nhất
SELECT K.TENKHOA, COUNT(*) AS SOLUONGGV
FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K
WHERE GV.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA
GROUP BY K.TENKHOA
HAVING COUNT(*) >= ALL 
(
	SELECT COUNT(*)
	FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K
	WHERE GV.MABM = BM.MABM AND BM.MAKHOA = K.MAKHOA
	GROUP BY K.TENKHOA
)

-- Q52. Cho biết họ tên giáo viên chủ nhiệm nhiều đề tài nhất
SELECT GV.HOTEN, COUNT(*) AS SODETAI
FROM GIAOVIEN AS GV, DETAI AS DT
WHERE GV.MAGV = DT.GVCNDT
GROUP BY GV.MAGV, GV.HOTEN
HAVING COUNT(*) >= ALL
(
	SELECT COUNT(*) AS SODETAI
	FROM GIAOVIEN AS GV, DETAI AS DT
	WHERE GV.MAGV = DT.GVCNDT
	GROUP BY GV.MAGV, GV.HOTEN
)

-- Q53. Cho biết mã bộ môn có nhiều giáo viên nhất
SELECT BM.MABM, COUNT(*) AS SOLUONG
FROM BOMON AS BM, GIAOVIEN AS GV
WHERE BM.MABM = GV.MABM
GROUP BY BM.MABM
HAVING COUNT(*) >= ALL
(
	SELECT COUNT(*) AS SOLUONG
	FROM BOMON AS BM, GIAOVIEN AS GV
	WHERE BM.MABM = GV.MABM
	GROUP BY BM.MABM
)

-- Q54. Cho biết tên giáo viên và tên bộ môn của giáo viên tham gia nhiều đề tài nhất.
SELECT GV.HOTEN, BM.TENBM
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM AND GV.HOTEN =
(
	SELECT GV.HOTEN
	FROM GIAOVIEN AS GV, THAMGIADT AS TGDT
	WHERE GV.MAGV = TGDT.MAGV
	GROUP BY GV.MAGV, GV.HOTEN
	HAVING COUNT(*) >= ALL
	(
		SELECT COUNT(*) AS SOLUONGDT
		FROM GIAOVIEN AS GV, THAMGIADT AS TGDT 
		WHERE GV.MAGV = TGDT.MAGV
		GROUP BY GV.MAGV, GV.HOTEN
	)
)
-- Q55. Cho biết tên giáo viên tham gia nhiều đề tài nhất của bộ môn HTTT.
SELECT GV.HOTEN, COUNT(*) AS SOLUONGDT
FROM GIAOVIEN AS GV, THAMGIADT AS TGDT
WHERE GV.MAGV = TGDT.MAGV
GROUP BY GV.MAGV, GV.HOTEN
HAVING COUNT(*) >= ALL
(
	SELECT COUNT(*)
	FROM GIAOVIEN AS GV, THAMGIADT AS TGDT
	WHERE GV.MAGV = TGDT.MAGV
	GROUP BY GV.MAGV, GV.HOTEN
	HAVING GV.HOTEN = ANY
	(
		SELECT GV.HOTEN
		FROM GIAOVIEN  AS GV, BOMON AS BM
		WHERE GV.MABM = BM.MABM AND BM.MABM = 'HTTT' 
	)
)
-- Q56. Cho biết tên giáo viên và tên bộ môn của giáo viên có nhiều người thân nhất.
SELECT GV.HOTEN, BM.TENBM
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM AND GV.HOTEN = ANY -- nếu trả về nhiều hơn 1 giá trị
(	
	SELECT GV.HOTEN
	FROM GIAOVIEN AS GV, NGUOITHAN AS NT
	WHERE GV.MAGV = NT.MAGV
	GROUP BY GV.MAGV, GV.HOTEN 
	HAVING COUNT(*) >= ALL
	(
		SELECT COUNT(*) AS SOLUONGNT
		FROM GIAOVIEN AS GV, NGUOITHAN AS NT
		WHERE GV.MAGV = NT.MAGV
		GROUP BY GV.MAGV, GV.HOTEN
	)
)
-- Q57. Cho biết tên trưởng bộ môn mà chủ nhiệm nhiều đề tài nhất.
SELECT GV.HOTEN
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM AND GV.MAGV = ANY
(
	SELECT GV.MAGV
	FROM GIAOVIEN AS GV, DETAI AS DT
	WHERE GV.MAGV = DT.GVCNDT
	GROUP BY GV.MAGV
	HAVING COUNT(*) >= ALL
	(
		SELECT COUNT(*) 
		FROM GIAOVIEN AS GV, DETAI AS DT
		WHERE GV.MAGV = DT.GVCNDT
		GROUP BY GV.MAGV
	)
)
-- NEED TEST Q58. Cho biết tên giáo viên nào mà tham gia đề tài đủ tất cả các chủ đề.
SELECT GV1.HOTEN 
FROM GIAOVIEN AS GV1
WHERE NOT EXISTS
(
	SELECT *
	FROM CHUDE AS CD
	WHERE NOT EXISTS
	(
		SELECT *
		FROM GIAOVIEN GV2 
		JOIN THAMGIADT AS TGDT 
		ON GV2.MAGV = TGDT.MAGV
		JOIN DETAI DT 
		ON TGDT.MADT = DT.MADT
		WHERE DT.MACD = CD.MACD
	)
)

--DON'T UNDERSTAND Q59. Cho biết tên đề tài nào mà được tất cả các giáo viên của bộ môn HTTT tham gia.
SELECT TENDT
FROM DETAI DT
WHERE DT.MADT IN
(
	SELECT DT.MADT
    FROM DETAI DT
    WHERE NOT EXISTS 
	(
		SELECT GV.MAGV
        FROM GIAOVIEN GV
        WHERE GV.MABM = 'HTTT'
        EXCEPT
        SELECT TGDT.MAGV
        FROM THAMGIADT TGDT
        WHERE DT.MADT = TGDT.MADT 
     )
)

SELECT DT.MADT
FROM DETAI DT
WHERE NOT EXISTS
(
	SELECT TGDT.MAGV
    FROM THAMGIADT TGDT
    WHERE DT.MADT = TGDT.MADT 
)

-- Q60. Cho biết tên đề tài có tất cả giảng viên bộ môn “Hệ thống thông tin” tham gia

-- Q61. Cho biết giáo viên nào đã tham gia tất cả các đề tài có mã chủ đề là QLGD.

-- Q62. Cho biết tên giáo viên nào tham gia tất cả các đề tài mà giáo viên Trần Trà Hương đã tham gia.

-- Q63. Cho biết tên đề tài nào mà được tất cả các giáo viên của bộ môn Hóa Hữu Cơ tham gia.

-- Q64. Cho biết tên giáo viên nào mà tham gia tất cả các công việc của đề tài 006.

-- Q65. Cho biết giáo viên nào đã tham gia tất cả các đề tài của chủ đề Ứng dụng công nghệ.

-- Q66. Cho biết tên giáo viên nào đã tham gia tất cả các đề tài của do Trần Trà Hương làm chủ nhiệm.

-- Q67. Cho biết tên đề tài nào mà được tất cả các giáo viên của khoa CNTT tham gia.

-- Q68. Cho biết tên giáo viên nào mà tham gia tất cả các công việc của đề tài Nghiên cứu tế bào gốc.

-- Q69. Tìm tên các giáo viên được phân công làm tất cả các đề tài có kinh phí trên 100 triệu?

-- Q70. Cho biết tên đề tài nào mà được tất cả các giáo viên của khoa Sinh Học tham gia.

-- Q71. Cho biết mã số, họ tên, ngày sinh của giáo viên tham gia tất cả các công việc của đề tài “Ứng dụng hóa học xanh”.

-- Q72. Cho biết mã số, họ tên, tên bộ môn và tên người quản lý chuyên môn của giáo viên tham gia tất cả các đề tài thuộc chủ đề “Nghiên cứu phát triển”.

-- Q73. Cho biết họ tên, ngày sinh, tên khoa, tên trưởng khoa của giáo viên tham gia tất cả các đề tài có giáo viên “Nguyễn Hoài An” tham gia.

-- Q74. Cho biết họ tên giáo viên khoa “Công nghệ thông tin” tham gia tất cả các công việc của đề tài có trưởng bộ môn của bộ môn đông nhất khoa “Công nghệ thông tin” làm chủ nhiệm.

-- Q75. Cho biết họ tên giáo viên và tên bộ môn họ làm trưởng bộ môn nếu có
SELECT GV.HOTEN, BM.TENBM
FROM GIAOVIEN AS GV
LEFT JOIN BOMON AS BM
ON GV.MAGV = BM.TRUONGBM

-- Q76. Cho danh sách tên bộ môn và họ tên trưởng bộ môn đó nếu có
SELECT BM.TENBM, GV.HOTEN 
FROM BOMON AS BM
LEFT JOIN GIAOVIEN AS GV
ON BM.TRUONGBM = GV.MAGV

-- Q77. Cho danh sách tên giáo viên và các đề tài giáo viên đó chủ nhiệm nếu có
SELECT GV.HOTEN, DT.TENDT
FROM GIAOVIEN AS GV
LEFT JOIN DETAI AS DT
ON GV.MAGV = DT.GVCNDT

-- Q78. Xóa các đề tài thuộc chủ đề “NCPT”.
DELETE FROM DETAI
WHERE MACD = 'NCPT'

-- Q79. Xuất ra thông tin của giáo viên (MAGV, HOTEN) và mức lương của giáo viên. Mức lương được xếp theo quy tắc: Lương của giáo viên < $1800 : “THẤP” ; Từ $1800 đến $2200: TRUNG BÌNH; Lương > $2200: “CAO”
SELECT MAGV, HOTEN,
CASE
    WHEN LUONG < 1800 THEN N'THẤP'
    WHEN LUONG BETWEEN 1800 AND 2200 THEN N'TRUNG BÌNH'
    ELSE N'CAO'
END AS MUCLUONG
FROM GIAOVIEN;

-- Q80. Xuất ra thông tin giáo viên (MAGV, HOTEN) và xếp hạng dựa vào mức lương. Nếu giáo viên có lương cao nhất thì hạng là 1.
SELECT HOTEN, LUONG,
RANK() OVER 
(
	ORDER BY LUONG DESC
) AS HANG
FROM GIAOVIEN 

-- NEED TEST Q81. Xuất ra thông tin thu nhập của giáo viên. Thu nhập của giáo viên được tính bằng LƯƠNG + PHỤ CẤP. Nếu giáo viên là trưởng bộ môn thì PHỤ CẤP là 300, và giáo viên là trưởng khoa thì PHỤ CẤP là 600.
SELECT DISTINCT GV.HOTEN, GV.LUONG,
CASE 
	WHEN GV.MAGV = BM.TRUONGBM THEN GV.LUONG + 300
	WHEN GV.MAGV = K.TRUONGKHOA THEN GV.LUONG + 600
END AS THUNHAP
FROM GIAOVIEN AS GV, BOMON AS BM, KHOA AS K

DECLARE @THUNHAP INT
 

SELECT 
FROM GIAOVIEN AS GV, BOMON AS BM

-- Q82. Xuất ra năm mà giáo viên dự kiến sẽ nghĩ hưu với quy định: Tuổi nghỉ hưu của Nam là 60, của Nữ là 55.
SELECT HOTEN, NGSINH, YEAR(GETDATE()) - YEAR(NGSINH) AS TUOI, PHAI,
CASE 
	WHEN PHAI = N'Nam' AND YEAR(GETDATE()) - YEAR(NGSINH) < 65 THEN YEAR (NGSINH) + (65 - (YEAR(GETDATE()) - YEAR(NGSINH)))
	WHEN PHAI = N'Nữ' AND YEAR(GETDATE()) - YEAR(NGSINH) < 55 THEN YEAR (NGSINH) + (55 - (YEAR(GETDATE()) - YEAR(NGSINH)))
END AS DUKIENNGHIHUU	
FROM GIAOVIEN

-----------------------------------------------------------------------------
SELECT AVG(LUONG) AS TRUNGBINHLUONG
FROM GIAOVIEN AS GV, BOMON AS BM
WHERE GV.MABM = BM.MABM
GROUP BY BM.MAKHOA

SELECT COUNT(*)
FROM KHOA AS K

SELECT K.MAKHOA, K.TENKHOA, COUNT(BM.MABM) AS SOBM
FROM BOMON AS BM, KHOA AS K
WHERE BM.MAKHOA = K.MAKHOA
GROUP BY K.MAKHOA, K.TENKHOA

